name: Build CV with AcademicCV.jl
on:
  push:
    branches-ignore:
    - '/pdflatex'
  schedule:
    - cron: "0 0 * * *" # Run at 00:00 every day
jobs:
  build_cv:
    runs-on: ubuntu-latest
    steps:
      - name: Set up Git repository
        uses: actions/checkout@v4
      
      - name: Setup Julia
        uses: julia-actions/setup-julia@v2
        with:
          version: '1.10'
      
      - name: Install LaTeX
        run: |
          sudo apt-get update
          sudo apt-get install -y texlive-latex-base texlive-latex-extra
      
      - name: Install AcademicCV.jl
        run: |
          julia --project=. -e 'using Pkg; Pkg.add(url="https://github.com/md-arif-shaikh/AcademicCV.jl")'
      
      - name: Build CV
        run: |
          julia --project=. scripts/build_cv.jl
      
      - name: Commit and push CV
        run: |
          git config user.name 'GitHub Action'
          git config user.email 'action@github.com'
          git add _data/arif/cv_arif.pdf
          git diff --staged --quiet || git commit -m "Update CV [skip ci]"
          git push
      
